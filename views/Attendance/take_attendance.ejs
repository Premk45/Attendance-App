<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Attendance Table</title>
    <link rel="stylesheet" href="/css/take_attendance.css">
    
</head>
<body>

    <% layout("./layouts/boilerplate.ejs") %>
    <h1>Attendance Sheet</h1>
<form action="/home/take_attendance" method="POST">
    <div class="container">
        <table class="attendance-table">
            <thead>
                <tr>
                    <th class="head">Name Of All Students</th>
                    <th>Absent</th>
                    <th>Present</th>
                </tr>
            </thead>
            <tbody>
                <% for(student of all_std) { %>
                    <tr class="std">
                        <td class="name"><%= student.name + ' ' + student.last_name %></td>
                        <td class="cheks"><input type="checkbox" 
                            class="checkbox" 
                            name="Absent"
                            onclick="ClickA()" 
                            id="<%= student.id %>">
                        </td>

                        <td class="cheks"><input type="checkbox" 
                            class="checkbox"  
                            name="Present"
                            onclick="ClickP()" 
                            id="<%= student.id %>Present">
                        </td>
                    </tr> 
                <% } %>
                <!-- Add more rows as needed -->
            </tbody>
        </table>
    </div>
    <div class="save">
        <button class="btnSave">Save</button>
    </div>
</form>
    

    <script>
           
            function ClickA(){
                let checkA = document.getElementsByName("Absent");
                for(check of checkA){
                    if(check.checked === true){
                        let Pid = `${check.id}Present`;
                        let checkB = document.getElementById(Pid);
                        checkB.disabled = true;
                        // console.dir(checkB);
                    }else{
                        let Pid = `${check.id}Present`;
                        let checkB = document.getElementById(Pid);
                        checkB.disabled = false;
                    }
                    
                }
            };


            function ClickP(){
                let checkP = document.getElementsByName("Present");
                for(check of checkP){
                    if(check.checked === true){
                        let id = new String(check.id);
                        let Aid = id.substr(0,24);
                        let checkB = document.getElementById(Aid);
                        checkB.disabled = true;
                        // console.log(Aid);
                    }
                    else{
                        let id = new String(check.id);
                        let Aid = id.substr(0,24);
                        let checkB = document.getElementById(Aid);
                        checkB.disabled = false;
                    }
                    
                }
            };

        const form = document.querySelector('form');

        form.addEventListener("submit" , (e) => {
            e.preventDefault();

            document.querySelectorAll('[type="checkbox"]').forEach(item => {
                const id = item.id;
                const absent = item.name=== "Absent";
                const present = item.name=== "Present";


                if(item.checked === true && item.name === "Absent"){
                    console.dir(item.id + item.name);
                }else if(item.checked === true && item.name === "Present"){
                    console.log(item.id + item.name);
                }
                else{
                    console.log("False");
                }  
            });
        });
    </script>
</body>
</html>
